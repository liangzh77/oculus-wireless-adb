# Oculus 无线 ADB 连接工具

## 问题解决

您遇到的 `FileNotFoundError: [WinError 2] 系统找不到指定的文件。` 错误已经解决！

### 问题原因
脚本尝试执行 `adb` 命令，但系统中没有安装 Android Debug Bridge (ADB) 工具。

### 解决方案
1. **已自动安装 ADB**：脚本已自动下载并安装了 Android SDK Platform Tools
2. **修改了代码**：增强了错误处理和 ADB 检测功能
3. **提供了工具**：创建了安装和测试脚本

## 文件说明

### 主要文件
- `discover-and-connect.py` - 主脚本，用于发现和连接 Oculus 设备
- `install_adb.py` - ADB 自动安装脚本
- `test_adb.py` - ADB 功能测试脚本
- `test_script.py` - 脚本功能测试脚本

### 安装的文件
- `platform-tools/` - Android SDK Platform Tools 目录
  - `adb.exe` - Android Debug Bridge 可执行文件

## 使用方法

### 1. 运行主脚本
```bash
python discover-and-connect.py
```

脚本会：
- 自动检测并使用本地安装的 ADB
- 搜索网络中的 Oculus 设备
- 自动连接到找到的设备
- 显示连接状态

### 2. 测试 ADB 功能
```bash
python test_adb.py
```

### 3. 测试脚本功能
```bash
python test_script.py
```

## 功能特点

### 增强的错误处理
- 自动检测 ADB 是否可用
- 优先使用系统 PATH 中的 ADB
- 回退到本地安装的 ADB
- 提供详细的错误信息

### 改进的连接逻辑
- 捕获并显示 ADB 命令的错误输出
- 检查命令返回码
- 提供连接状态反馈

## 故障排除

### 如果仍然遇到问题

1. **检查 ADB 安装**：
   ```bash
   python test_adb.py
   ```

2. **重新安装 ADB**：
   ```bash
   python install_adb.py
   ```

3. **手动添加到 PATH**：
   - 将 `C:\liangz77\python_projects\oculus-wireless-adb\script\platform-tools` 添加到系统 PATH
   - 重启命令提示符或 IDE

### 常见问题

**Q: 脚本运行但没有找到设备？**
A: 确保 Oculus 设备已开启无线 ADB 功能，并且与电脑在同一网络。

**Q: 连接失败？**
A: 检查设备是否支持无线 ADB，以及网络连接是否正常。

**Q: 权限问题？**
A: 确保以管理员权限运行脚本。

## 技术细节

### 修改的代码
1. 添加了 `shutil` 和 `pathlib` 导入
2. 增强了 ADB 检测逻辑
3. 改进了错误处理和输出
4. 使用绝对路径调用 ADB

### 依赖项
- `zeroconf==0.39.4` - 用于网络服务发现
- Android SDK Platform Tools - 用于 ADB 连接

## 下一步

现在您可以：
1. 运行 `python discover-and-connect.py` 开始搜索设备
2. 确保 Oculus 设备已开启无线 ADB
3. 等待脚本自动发现并连接设备

脚本现在应该可以正常工作，不再出现文件找不到的错误！
